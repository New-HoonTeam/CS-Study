# 정규화

정규화 원칙에 따라 하나의 릴레이션을 릴레이션을 여러 개로 분리하는 과정

## 정규화 원칙

1. **정보의 무손실** : 나누어진 릴레이션이 표현하는 정보는 나누어지기 전 정보를 모두 포함해야 한다.
2. **최소 데이터 중복** : 데이터 중복을 최소화하여, 이상 현상을 제거한다.
3. **분리의 원칙** : 하나의 독립된 관계성은 하나의 독립된 릴레이션으로 분리해서 표현

## 이상 현상

데이터들이 불필요하게 중복되어 릴레이션 조작에 예기치 못한 문제 발생

### 삽입 이상

삽입하고자 하는 데이터 외에 불필요한 데이터까지 같이 삽입해야 하는 현상

### 갱신 이상

중복되는 데이터의 일부만 갱신되어 데이터 일관성이 깨지는 현상

### 삭제 이상

삭제하고자 하는 데이터와 더불어 원치 않는 정보도 삭제되는 현상

## 정규화의 장점

- 정규화된 데이터베이스를 확장할 때, 그 구조를 변경하지 않아도 되거나, 일부만 변경해도 된다.
- 중복된 데이터를 배제함으로 효율적인 저장 공간 사용
- 잘못된 종속관계로 인해 발생하는 이상현사을 제거한다.

## 정규화의 단점

- 릴레이션의 분해로 릴레이션 간의 JOIN 연산이 많아진다.
- 데이터 처리 속도가 느려질 수도 있다.

## 정규화의 종류

### 기본 정규형

- 제 1 정규형
- 제 2 정규형
- 제 3 정규형
- BCNF 정규형

### 고급 정규형

- 제 4 정규형
- 제 5 정규형

고급 정규화를 해야하는 상황이 많지 않아, 기본 정규형인 
제 3 정규형 혹은 BCNF 정규형까지 정규화를 진행하는 것이 일반적이다.

# 제 1 정규형

릴레이션의 모든 도메인이 더 이상 분해될 수 없는 원자 값(atomic value)만으로 구성되어야 한다.

| 고객 id | 이름 | 전화번호 |
| --- | --- | --- |
| 101 | 김철수 | 111-1234, 222-3456 |
| 201 | 권만식 | 333-4567, 444-5678 |
| 327 | 박진석 | 555-6789, 666-7890 |

전화번호 attribute에 여러 값이 들어가서 제 1정규형이 위배되었다.

| 101 | 김철수 |
| --- | --- |
| 201 | 권만식 |
| 327 | 박진석 |

| 101 | 111-1234 |
| --- | --- |
| 101 | 222-3456 |
| 201 | 333-4567 |
| 201 | 444-5678 |
| 327 | 444-5678 |
| 327 | 66607890 |

두 릴레이션으로 나누어, 전화번호에 한 값만 들어가게 정규화

# 제 2 정규화

제 1 정규형을 만족하면서, **부분함수 종속성이 제거**된 정규형 

- 부분함수 종속성
    
    기본키의 부분 집합이 결정자가 되는 것
    예를 들어 기본키의 집합이 {A, B} 라고 했을 때, 
    B에 의해서만 다른 non-primary attribute가 결정 되는 것
    

⇒ 기본키의 부분 집합이 결정자가 되지 않게 하는 것

| 학생번호 | 강의명 | 강의실 | 성적 |
| --- | --- | --- | --- |
| 101 | 데이터베이스 | 미래관 110 | 3.5 |
| 102 | 데이터베이스 | 미래관 110 | 3.1 |
| 201 | 네트워크 | 공학관 205 | 2.9 |
| 303 | 자료구조 | 공학관 501 | 3.2 |
| 305 | 자료구조 | 공학관 501 | 3.7 |
- 기본키 : {학생번호, 강의명}
- 학생 번호, 강의명 → 성적
- 강의명 → 강의실

기본키의 부분집합인 강좌이름만으로 강의실이 결정되는 부분함수 종속성을 확인할 수 있다.

갱신 이상  - 강의실 수정시 데이터 일관성이 깨질 수 있다.

| 학생번호 | 강의명 | 성적 |
| --- | --- | --- |
| 101 | 데이터베이스 | 3.5 |
| 102 | 데이터베이스 | 3.1 |
| 201 | 네트워크 | 2.9 |
| 303 | 자료구조 | 3.2 |
| 305 | 자료구조 | 3.7 |

| 강의명 | 강의실 |
| --- | --- |
| 데이터베이스 | 미래관 110 |
| 네트워크 | 공학관 205 |
| 자료구조 | 공학관 501 |

{학생 번호, 강의명 → 성적}, {강의명 → 강의실}
각각의 함수적 종속성을 개별 테이블으로 나눔으로써 정규화

# 제 3 정규화

제 2정규형을 만족하면서, 이행적 함수 종속성을 제거한 정규형

- 이행적 함수 종속성
    
    A → B, B → C가 일 때, A → C가  성립하는 것을 의미
    

| 회원 번호 | 등급 | 할인율 |
| --- | --- | --- |
| 1 | GOLD | 40% |
| 2 | SLIVER | 20% |
| 3 | BRONZE | 10% |

기본키 : 회원 번호

이상 현상

삽입 이상 - 회원이 추가될 때마다, **불필요한 중복 데이터**인 할인율이 계속 추가되어야 한다.

갱신 이상 - 등급에 따른 할인율이 수정될 때, 데이터 일관성이 깨질 수 있다.

삭제 이상 - 만약, GOLD 등급을 유지하고 있는 단 한명의 회원이 삭제되면, GOLD 등급도 사라진다.

| 회원 번호 | 등급 |
| --- | --- |
| 1 | GOLD |
| 2 | SLIVER |
| 3 | BRONZE |

| 등급 | 할인율 |
| --- | --- |
| GOLD | 40% |
| SLIVER | 20% |
| BRONZE | 10% |

{ 회원 번호 → 등급}, {등급 → 할인율} 
각각의 함수적 종속성을 개별 테이블으로 나눔으로써 정규화

# BCNF 정규화

제 3 정규형을 만족하면서, 모든 결정자가 후보키 집합에 속해야 한다.

즉, 후보키 집합이 아닌 attribute가 결정자가 되어서는 안된다.

제약 사항 : 한 명의 강의자는 한 개의 강의만 담당할 수 있다.

| 학생 | 강의 | 강의자 |
| --- | --- | --- |
| 정승환 | 예능의 이해 | 유재석 |
| 정승환 | 호흡과 발성 | 이영현 |
| 샘김 | 뮤지컬의 이해 | 박효신 |
| 신효섭 | 예능의 이해 | 유재석 |

- 기본키 {학생, 강의} → 강의자
- 강의자 → 강의

기본키가 아닌 attribute에 의해 기본키가 결정된다.

삽입 이상 - 수강생이 없으면 강의를 추가할 수 없다.

갱신 이상 - 유재석이 담당하는 강의가 수정될 때, 데이터 일관성이 깨질 수 있다.

삭제 이상 - 수강생이 1명인 강의의 수강생이 수강 취소하면 강의도 사라진다.

| 학생 | 강사 |
| --- | --- |
| 정승환 | 유재석 |
| 정승환 | 이영현 |
| 샘김 | 박효신 |
| 신효섭 | 유재석 |

| 과목명 | 강사 |
| --- | --- |
| 예능의 이해 | 유재석 |
| 호흡과 발성 | 이영현 |
| 뮤지컬의 이해 | 박효신 |

기본키를 결정한 attribute만 남기고, 그 종속성은 다른 테이블로 분리

# 참고

[[DB] 정규화(Normalization)란? 정규화 예시, 1NF, 2NF, 3NF, BCNF](https://code-lab1.tistory.com/48)

[[DB] 7. 정규화 & 함수 종속성 & 이상현상](https://rebro.kr/159)

[데이터베이스 정규화(Normalization)란](https://hongcoding.tistory.com/147)

[[Database] 정규화(Normalization) 쉽게 이해하기](https://mangkyu.tistory.com/110)

[[Database] 정규화(Normalization) 과정 (1NF, 2NF, 3NF, BCNF)](https://hoyeonkim795.github.io/posts/normalization-course/)

[[DB] 8. 정규형 (1NF, 2NF, 3NF, BCNF)](https://rebro.kr/160)

[정보처리기사 데이터베이스 정규화](https://youtu.be/rVxcheAkMSk)
